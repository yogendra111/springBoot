package com.hystrixproj.controllers;
import java.util.Random;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand;

@RestController
@RequestMapping("/payment")
public class PaymentRestController {

       @GetMapping("/pay")
       @HystrixCommand(fallbackMethod = 'doDummyPay')
       public String doPayment(){
    	   System.out.println("---Start of  PAYMENT-METHOD---");
    	   if(new Random().nextInt(10) <=10) {
    		   throw new RuntimeException("DUMMY Example");
    	   }
    	   System.out.println("---End of PAYMENT-METHOD---");
    	   return "SUCCESS";
       }

       public String doDummyPay(){
    	   System.out.println("---FROM FALLBACK METHOD---");
    	   return "SERVICE IS DOWN, PLEASE TRY AFTER SOMETIME !!!";
       }
}